;
(self.AMP=self.AMP||[]).push({m:1,v:"2506201720000",n:"amp-gwd-animation",ev:"0.1",l:!0,f:function(t,n){(()=>{var{isArray:n}=Array,{hasOwnProperty:i,toString:e}=Object.prototype;function s(t,n){return i.call(t,n)}function o(t){return(t.ownerDocument||t).defaultView}function r(t){return CSS.escape(t)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var a=self.__AMP_LOG;function c(t){return a.user||(a.user=u()),function(t,n){return n&&n.ownerDocument.defaultView!=t}(a.user.win,t)?a.userForEmbed||(a.userForEmbed=u()):a.user}function u(t){return function(t,n){throw new Error("failed to call initLogConstructor")}()}function l(t,n,i,e,s,o,r,a,c,u,l){return t}function h(t,n,i,e,s,o,r,a,u,l,h){return c().assert(t,n,i,e,s,o,r,a,u,l,h)}function d(t,n){const i=function(t){const n=g(t);return n.isSingleDoc()?n.win:n}(g(t));return m(i,n)?_(i,n):null}function f(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}function g(t){return t.nodeType?(n=o(t),function(t,n){return _(t=f(t),"ampdoc")}(n)).getAmpDoc(t):t;var n}function _(t,n){l(m(t,n));const i=function(t){let n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}(t)[n];return i.obj||(l(i.ctor),l(i.context),i.obj=new i.ctor(i.context),l(i.obj),i.context=null,i.resolve&&i.resolve(i.obj)),i.obj}function m(t,n){const i=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!i||!i.ctor)}var P=t=>d(t,"action"),A="gwd-page-wrapper",v="gwd-pause-animation",E="gwd-play-animation",p="data-gwd-label-animation",w="gwd.timelineEvent",T=["animationend","webkitAnimationEnd"],b="__AMP_GWD_GOTO_COUNTERS__",R="GWD",I="amp-gwd-animation",M={"play":["args.id"],"pause":["args.id"],"togglePlay":["args.id"],"gotoAndPlay":["args.id","args.label"],"gotoAndPause":["args.id","args.label"],"gotoAndPlayNTimes":["args.id","args.label","args.N","event.detail.eventName"],"setCurrentPage":["args.index"]},y=class extends t.BaseElement{constructor(t){super(t),this.$0="",this.G0=null,this.N0=this.O0.bind(this)}buildCallback(){this.$0=this.element.getAttribute("timeline-event-prefix")||"";const t=function(t,n){const i=(t.ownerDocument||t).defaultView,e=n||f(i);if(i&&i!=e&&f(i)==e)try{return i.frameElement}catch(t){}return null}(this.element,this.getAmpDoc().win);t&&(this.G0=t.__AMP_EMBED__),this.qI().addEventListener(w,this.N0,!0);const n=this.D0();if(n){h(this.element.id,`The ${I} element must have an id.`);const t=`${this.element.id}.setCurrentPage(index=event.index)`;!function(t,n,i,e){let s;const o=n.getAttribute("on")||"",r="slideChange:",a=o.indexOf(r);if(-1!=a){const t=a+r.length;s=o.substr(0,t)+e+","+o.substr(t)}else s=o,s&&(s+=";"),s+=`slideChange:${e}`;P(t).setActions(n,s)}(this.element,n,0,t)}const i=this.W0.bind(this);for(const t in M)this.registerAction(t,i)}qI(){return this.G0?this.G0.win.document:this.getAmpDoc().getRootNode()}D0(){return this.qI().getElementById("pagedeck")}W0(t){this.F0(t)&&this.j0(t)}F0(t){if("setCurrentPage"==t.method){const n=this.D0();return n&&t.source==n}return!0}j0(t){const n=h(d(this.element,"gwd"),"Cannot execute action because the GWD service is not registered."),i=M[t.method].map((n=>function(t,n){const i=n.split(".");let e=t;for(let t=0;t<i.length;t++){const n=i[t];if(!n||!e||void 0===e[n]){e=void 0;break}e=e[n]}return e}(t,n)));n[t.method].apply(n,i)}O0(t){const n=P(this.element),i=function(t){return t.detail}(t).eventName,e=`${this.$0}${i}`;n.trigger(this.element,e,t,3)}detachedCallback(){return this.qI().removeEventListener(w,this.N0,!0),!0}};t.registerServiceForDoc("gwd",class{constructor(t){this.zi=t,this.i=t.win,this._f=this.i.document,this.U0=this.q0.bind(this),t.whenReady().then((()=>{const t=this._f.body;!function(t,n,i){if(n())i();else{const e=new(o(t).MutationObserver)((()=>{n()&&(e.disconnect(),i())}));e.observe(t,{childList:!0})}}(t,(()=>!!t.querySelector(`.${r(A)}`)),this.Ue.bind(this))}))}Ue(){this.z0(),this.setCurrentPage(0)}setEnabled(t){this._f.body.classList.toggle("i-amphtml-gwd-animation-disabled",!t)}setCurrentPage(t){const n=this._f.body.querySelectorAll(`.${r(A)}`);if(0==n.length)return;const i=(e=`.${r(A)}.${r(E)}`,this._f.body.querySelector(function(t,n){return t.replace(/^|,/g,"$&:scope ")}(e)));var e;i&&this.H0(i);const s=n[t];s?this.B0(s):c().error(R,"Could not find page with index "+t+".")}B0(t){t.classList.add(E)}H0(t){var n;t.classList.remove(E),[t].concat((n=t.querySelectorAll("*"),n?Array.prototype.slice.call(n):[])).forEach((t=>this.J0(t)))}J0(t){if(t.classList.remove(v),t.hasAttribute(p)){const n=t.getAttribute(p);t.classList.remove(n),t.removeAttribute(p)}delete t[b]}play(t){const n=this.getReceiver(t);n&&n.classList.remove(v)}pause(t){const n=this.getReceiver(t);n&&n.classList.add(v)}togglePlay(t){const n=this.getReceiver(t);n&&n.classList.toggle(v)}gotoAndPlay(t,n){const i=this.getReceiver(t);i&&this.K0(i,n)}gotoAndPause(t,n){const i=this.getReceiver(t);i&&(this.K0(i,n),this.i.setTimeout((()=>{this.pause(t)}),40))}gotoAndPlayNTimes(t,n,i,e){if(i<=0)return void c().error(R,`Invalid maxCount parameter: ${i}`);if(!e)return void c().error(R,"Event name required but not specified.");const o=this.getReceiver(t);if(!o)return;const r=`${e}_${n}`,a=function(t,n){return t[b]&&s(t[b],n)?t[b][n]:0}(o,r);a<i&&(this.K0(o,n),function(t,n,i){t[b]||(t[b]={}),s(t[b],n)||(t[b][n]=0),t[b][n]=i}(o,r,a+1))}getReceiver(t){if("document.body"==t)return this._f.body;const n=this._f.getElementById(t);return n&&n.classList?n:(c().error(R,`Could not get receiver with id ${t}.`),null)}K0(t,n){t.classList.remove(v);const i=t.getAttribute(p);i&&(t.classList.remove(i),t.removeAttribute(p)),i==n&&function(t){const n="__AMP_GWD_TEMP";self[n]=t.offsetWidth,delete self[n]}(t),t.classList.add(n),t.setAttribute(p,n)}q0(t){const n=t.target.getAttribute("data-event-name");if(!n)return;const i={"eventName":n,"sourceEvent":t},e=function(t,n,i,e){const s={detail:i};return Object.assign(s,void 0),new t.CustomEvent("gwd.timelineEvent",s)}(this.i,0,i);this._f.dispatchEvent(e)}z0(){for(let t=0;t<T.length;t++)this._f.body.addEventListener(T[t],this.U0,!0)}Q0(){for(let t=0;t<T.length;t++)this._f.body.removeEventListener(T[t],this.U0,!0)}dispose(){this.Q0()}}),t.registerElement(I,y,".i-amphtml-gwd-animation-disabled [class*=-animation],.i-amphtml-gwd-animation-disabled [class*=gwdanimation]{animation:none!important}\n/*# sourceURL=/extensions/amp-gwd-animation/0.1/amp-gwd-animation.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-gwd-animation-0.1.mjs.map